testna(x)
x
testna=function(x){
p1=which(is.na(x))
p2=which(x==" ")
p3=which(x==".")
pp1=rbind(p1%%nrow(x),p1%/%nrow(x)+1)
pp1[2,which(pp1[1,]==0)]=pp1[2,which(pp1[1,]==0)]-1
pp1[1,which(pp1[1,]==0)]=nrow(x)
colnames(pp1)=x("x","y")
pp2=rbind(p2%%nrow(x),p2%/%nrow(x)+1)
pp2[2,which(pp2[1,]==0)]=pp2[2,which(pp2[1,]==0)]-1
pp2[1,which(pp2[1,]==0)]=nrow(x)
colnames(pp2)=x("x","y")
pp3=rbind(p3%%nrow(x),p3%/%nrow(x)+1)
pp3[2,which(pp3[1,]==0)]=pp3[2,which(pp3[1,]==0)]-1
pp3[1,which(pp3[1,]==0)]=nrow(x)
colnames(pp3)=x("x","y")
return(list(t(pp1),t(pp2),t(pp3)))
}
testna(x)
y=c(0,0,0)
testna(y)
testna=function(x){
p1=which(is.na(x))
p2=which(x==" ")
p3=which(x==".")
pp1=rbind(p1%%nrow(x),p1%/%nrow(x)+1)
pp1[2,which(pp1[1,]==0)]=pp1[2,which(pp1[1,]==0)]-1
pp1[1,which(pp1[1,]==0)]=nrow(x)
colnames(pp1)=c("x","y")
pp2=rbind(p2%%nrow(x),p2%/%nrow(x)+1)
pp2[2,which(pp2[1,]==0)]=pp2[2,which(pp2[1,]==0)]-1
pp2[1,which(pp2[1,]==0)]=nrow(x)
colnames(pp2)=c("x","y")
pp3=rbind(p3%%nrow(x),p3%/%nrow(x)+1)
pp3[2,which(pp3[1,]==0)]=pp3[2,which(pp3[1,]==0)]-1
pp3[1,which(pp3[1,]==0)]=nrow(x)
colnames(pp3)=c("x","y")
return(list(t(pp1),t(pp2),t(pp3)))
}
testna(y)
testna(x)
testna=function(x){
p1=which(is.na(x))
p2=which(x==" ")
p3=which(x==".")
pp1=rbind(p1%%nrow(x),p1%/%nrow(x)+1)
pp1[2,which(pp1[1,]==0)]=pp1[2,which(pp1[1,]==0)]-1
pp1[1,which(pp1[1,]==0)]=nrow(x)
pp1=t(pp1)
colnames(pp1)=c("x","y")
pp2=rbind(p2%%nrow(x),p2%/%nrow(x)+1)
pp2[2,which(pp2[1,]==0)]=pp2[2,which(pp2[1,]==0)]-1
pp2[1,which(pp2[1,]==0)]=nrow(x)
pp2=t(pp2)
colnames(pp2)=c("x","y")
pp3=rbind(p3%%nrow(x),p3%/%nrow(x)+1)
pp3[2,which(pp3[1,]==0)]=pp3[2,which(pp3[1,]==0)]-1
pp3[1,which(pp3[1,]==0)]=nrow(x)
pp3=t(pp3)
colnames(pp3)=c("x","y")
return(list(pp1,pp2,pp3))
}
testna(x)
testna(y)
testna(y)[1]
testna(y)[1]==NA
testna(y)[1]
testna(x)
is.na(testna(x)[1])
testna(x)[1]==" "
testna(x)[1]==""
testna(x)[1]=="."
?source
library(ggmap)
data.port=read.table(file="C:/Users/TSR/Desktop/高統r/airports.dat",sep=",")
data.line=read.table(file="C:/Users/TSR/Desktop/高統r/routes .dat",sep=",")
library(stringr)
portintw <- str_detect(data.port[,'V4'], "Taiwan")
twport <- data.port[portintw,]
data.port= data.port[,c('V3','V5','V7','V8','V9')]
names(data.port) <- c('city','code','lan','lon','att')
twport <-twport[twport$V5!='',
c('V3','V5','V7','V8','V9')]
names(twport) <- c('city','code','lan','lon','att')
lineintw <- data.line[,'V3'] %in% twport$code
twline <- data.line[lineintw,c('V3','V5','V9')]
outport=data.port[data.port$code  %in% twline[,"V5"],]
names(twline) <- c('source','destination','equipment')
findposition <- function(code) {
find <- twport$code==code
x <- twport[find,'lon']
y <- twport[find,'lan']
return(data.frame(x,y))
}
too <- function(code) {
find <- data.port$code==code
x <- data.port[find,'lon']
y <- data.port[find,'lan']
return(data.frame(x,y))
}
from <- lapply(as.character(twline$source),findposition)
from <- do.call('rbind',from)
from$group <- 1:dim(from)[1]
names(from) <- c('lon','lan','group')
to <- lapply(as.character(twline$destination),too)
to <- do.call('rbind',to)
to$group <-1:dim(to)[1]
names(to) <-c('lon','lan','group')
data.line <- rbind(from,to)
ggmap(get_googlemap(center = 'taiwan', zoom=3,size=c(1800,1200),
maptype='roadmap'),extent='device')+
geom_point(data=twport,aes(x=lon,y=lan),
colour = 'red4',alpha=0.8)+
geom_point(data=outport,aes(x=lon,y=lan),
colour = 'red4',alpha=0.8)+
geom_line(data=data.line,aes(x=lon,y=lan,group=group),
size=0.1,alpha=1,color='red4')
x=scan(file="C:\\Users\\TSR\\Desktop\\無母數報告\\sss.txt")
xmean=mean(x)
z=(xmean-10)/(sd(x)/50^(1/2))
p=1-pnrom(z)
p=1-pnorm(z)
print("因母體為常態，而且樣本數大於50，用z檢定")
print("H0:樣本平均等於10,H1:樣本平均大於10")
paste(p,">0.05,not reject H0",sep="")
z
library(TSA)
x=read.table(file="C:\\Users\\TSR\\Desktop\\時間序列\\4444.txt")
cc=x$V3
cc
###原本
plot.ts(cc,type="o")
acf(cc)
pacf(cc)
####
###處理季節效應
cc1=diff(log(cc),lag=4)
plot.ts(cc1)
acf(cc1,lag.max=30)
pacf(cc1,lag.max=30)
eacf(cc1)
####ma2
m1=arima(cc,order=c(4,0,2),seasonal=list(order=c(0,1,0),period=4))
m1
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
###ar5
m1=arima(cc,order=c(5,0,0),seasonal=list(order=c(0,1,0),period=4))
m1
m1=arima(cc2,order=c(0,0,3),seasonal=list(order=c(1,1,0),period=4))
m1
library(TSA)
x=read.table(file="C:\\Users\\TSR\\Desktop\\時間序列\\4444.txt")
cc=x$V3
cc
###原本
plot.ts(cc,type="o")
acf(cc)
pacf(cc)
####
###處理季節效應
cc1=diff(log(cc),lag=4)
plot.ts(cc1)
acf(cc1,lag.max=30)
pacf(cc1,lag.max=30)
eacf(cc1)
####ma2
m1=arima(cc,order=c(4,0,0),seasonal=list(order=c(0,1,0),period=4))
m1
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
###ar5
m1=arima(cc,order=c(5,0,0),seasonal=list(order=c(0,1,0),period=4))
m1
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
####
m1=arima(cc,order=c(1,0,0),seasonal=list(order=c(0,1,0),period=4))
m1
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=4,type='b')
cc=x$V3
cc1=cc[1:95]
cc2=cc[96:196]
plot.ts(cc1,type="o")
plot.ts(cc2,type="o")
acf(cc1)
pacf(cc1)
cc1=diff(cc1,lag=4)
cc2=diff(cc2,lag=4)
plot.ts(cc1)
plot.ts(cc2)
acf(cc1)
pacf(cc1)
acf(cc2)
pacf(cc2)
eacf(cc2)
cc=x$V3
cc1=cc[1:95]
cc2=cc[96:196]
m1=arima(cc1,order=c(1,0,0),seasonal=list(order=c(1,1,0),period=4))
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
acf(cc2)
pacf(cc2)
m1=arima(cc2,order=c(0,0,1),seasonal=list(order=c(1,1,0),period=4))
plot.ts(cc2,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
m1=arima(cc2,order=c(0,0,3),seasonal=list(order=c(1,1,0),period=4))
m1
m1=arima(cc2,order=c(0,0,3),seasonal=list(order=c(1,1,0),period=4))
m1
plot.ts(cc2,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
acf(rstandard(m1))
m1=arima(cc2,order=c(0,0,4),seasonal=list(order=c(1,1,0),period=4))
m1
plot.ts(cc2,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
m1=arima(cc2,order=c(0,0,3),seasonal=list(order=c(1,1,0),period=4))
m1
m1=arima(cc2,order=c(0,0,2),seasonal=list(order=c(1,1,0),period=4))
m1
eacf(cc2)
m1=arima(cc2,order=c(0,0,1),seasonal=list(order=c(1,1,0),period=4))
plot.ts(cc2,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
m1=arima(cc2,order=c(0,0,2),seasonal=list(order=c(1,1,0),period=4))
m1
plot.ts(cc2,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
m1=arima(cc2,order=c(1,0,3),seasonal=list(order=c(1,1,0),period=4))
m1
acf(rstandard(m1))
m1=arima(cc2,order=c(0,0,3),seasonal=list(order=c(1,1,0),period=4))
m1
plot.ts(cc2,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
```
m1=arima(cc,order=c(5,0,0),seasonal=list(order=c(0,1,0),period=4))
m1
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
####
m1=arima(cc,order=c(1,0,0),seasonal=list(order=c(0,1,0),period=4))
m1
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
m1=arima(cc,order=c(5,0,0),seasonal=list(order=c(0,1,0),period=4))
m1
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
cc1=diff(cc1,lag=4)
cc2=diff(cc2,lag=4)
plot.ts(cc1)
plot.ts(cc2)
cc1=diff(cc1,lag=4)
acf(cc1)
plot.ts(cc1,type="o")
cc=x$V3
cc1=cc[1:95]
cc2=cc[96:196]
plot.ts(cc1,type="o")
plot.ts(cc2,type="o")
acf(cc1)
pacf(cc1)
cc1=cc[1:95]
cc2=cc[96:196]
plot.ts(cc1,type="o")
acf(cc1)
pacf(cc1)
cc1=diff(cc1,lag=4)
cc2=diff(cc2,lag=4)
acf(cc1)
pacf(cc1)
acf(cc1)
pacf(cc1)
m1=arima(cc1,order=c(5,0,0))
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
cc=x$V3
cc1=cc[1:95]
cc2=cc[96:196]
plot.ts(cc1,type="o")
acf(cc1)
pacf(cc1)
acf(cc1)
cc1=diff(cc1,lag=4)
acf(cc1)
pacf(cc1)
m1=arima(cc1,order=c(5,0,0),seasonal=list(order=c(0,1,0),period=4)　)
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
m1=arima(cc1,order=c(5,0,0))
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
cc=x$V3
cc1=cc[1:95]
cc2=cc[96:196]
##ar5
m1=arima(cc1,order=c(5,0,0))
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
m1=arima(cc1,order=c(5,0,0),seasonal=list(order=c(1,1,0),period=4)　)
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
cc=x$V3
cc1=cc[1:95]
cc2=cc[96:196]
##ar5
m1=arima(cc1,order=c(5,0,0),seasonal=list(order=c(1,1,0),period=4)　)
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
plot.ts(cc2,type="o")
acf(cc2)
pacf(cc2)
m1=arima(cc2,order=c(0,0,1),seasonal=list(order=c(1,1,0),period=4))
plot.ts(cc2,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
m1=arima(cc2,order=c(0,0,3),seasonal=list(order=c(1,1,0),period=4))
m1
plot.ts(cc2,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
m1=arima(cc2,order=c(5,0,0),seasonal=list(order=c(1,1,0),period=4)　)
m1
plot.ts(cc2,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
library(TSA)
x=read.table(file="C:\\Users\\TSR\\Desktop\\時間序列\\4444.txt")
cc=x$V3
cc1=cc[1:70]
m1=arima(cc1,order=c(1,0,0),seasonal=list(order=c(1,1,0),period=4))
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
cc=x$V3
cc1=cc[1:70]
m1=arima(cc1,order=c(5,0,0),seasonal=list(order=c(1,1,0),period=4)　)
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
cc1=cc[1:70]
plot.ts(cc1,type="o")
m1=arima(cc1,order=c(5,0,0),seasonal=list(order=c(1,1,0),period=4)　)
m1
plot.ts(cc1,col="red")
lines(fitted(m1),col="blue")
plot(rstandard(m1))
abline(h=c(2,-2))
qqnorm(rstandard(m1))
qqline(rstandard(m1))
acf(rstandard(m1))
pacf(rstandard(m1))
plot(m1,n.ahead=20,type='b')
cc1=cc[1:30]
m1=arima(cc1,order=c(1,0,0),seasonal=list(order=c(1,1,0),period=4))
0
plot(m1,n.ahead=20,type='b')
